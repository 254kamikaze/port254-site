<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Honeypot Dashboard - port254</title>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./dashboard_style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <a href="index.html" style="text-decoration: none;">
                <h1 class="logo">port254</h1>
            </a>
        </div>
    </header>

    <!-- Navigation -->
    <div class="filters-section">
        <div class="container">
            <nav class="nav-menu" style="justify-content: center;">
                <a href="index.html" class="nav-link">Home</a>
                <a href="detections.html" class="nav-link">Detections</a>
                <a href="honeypot-dashboard.html" class="nav-link active">Honeypot Dashboard</a>
                <a href="attack-matrix.html" class="nav-link">ATT&CK Matrix</a>
                <a href="file-analysis.html" class="nav-link">File Analysis</a>
                <a href="incident-response.html" class="nav-link">Incident Response</a>
                <a href="getting-started.html" class="nav-link">Getting Started</a>
                <a href="documentation.html" class="nav-link">Documentation</a>
                <a href="contact.html" class="nav-link">Contact</a>
            </nav>
        </div>
    </div>

    <!-- Subtitle -->
    <div class="subtitle-section">
        <div class="container">
            <div class="subtitle-content">
                <p class="subtitle">ðŸ”´ LIVE Honeypot Telemetry - Perth, Australia | Auto-refresh: 30s</p>
            </div>
        </div>
    </div>

    <!-- Live Stats -->
    <div class="stats-section">
        <div class="container">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalEvents">-</div>
                    <div class="stat-label">Events (24h)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value stat-value-orange" id="uniqueIPs">-</div>
                    <div class="stat-label">Unique IPs</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="sshLogins">-</div>
                    <div class="stat-label">SSH Login Attempts</div>
                </div>
                <div class="stat-card honeypot-health-card">
                    <div class="honeypot-header">
                        <svg class="honeypot-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                        </svg>
                        <span class="honeypot-label">Infrastructure Health</span>
                    </div>
                    <div class="honeypot-status-grid">
                        <div class="health-item">
                            <span class="health-indicator health-online"></span>
                            <span class="health-label">SSH</span>
                            <span class="health-port">:22</span>
                        </div>
                        <div class="health-item">
                            <span class="health-indicator health-online"></span>
                            <span class="health-label">S7comm</span>
                            <span class="health-port">:102</span>
                        </div>
                        <div class="health-item">
                            <span class="health-indicator health-online"></span>
                            <span class="health-label">Modbus</span>
                            <span class="health-port">:502</span>
                        </div>
                        <div class="health-item">
                            <span class="health-indicator health-online"></span>
                            <span class="health-label">ELK</span>
                            <span class="health-status">Indexing</span>
                        </div>
                    </div>
                    <div class="honeypot-footer-stats">
                        <div class="footer-stat">
                            <span class="stat-number">99.2%</span>
                            <span class="stat-text">Uptime</span>
                        </div>
                        <div class="footer-stat">
                            <span class="stat-number" id="liveHMICount">-</span>
                            <span class="stat-text">HMI (24h)</span>
                        </div>
                    </div>
                </div>
                <!-- SPLIT: SSH Compromised -->
                <div class="stat-card" title="Successful SSH login attempts by attackers">
                    <div class="stat-value stat-value-red" id="sshCompromised">-</div>
                    <div class="stat-label">SSH Compromised</div>
                </div>
                <!-- SPLIT: HTTP Compromised -->
                <div class="stat-card" title="Successful HTTP login attempts by attackers">
                    <div class="stat-value stat-value-red" id="httpCompromised">-</div>
                    <div class="stat-label">HTTP Compromised</div>
                </div>
                <div class="stat-card honeypot-card">
                    <div class="honeypot-header">
                        <svg class="honeypot-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <circle cx="12" cy="12" r="2"></circle>
                            <path d="M16.24 7.76a6 6 0 0 1 0 8.49m-8.48-.01a6 6 0 0 1 0-8.49m11.31-2.82a10 10 0 0 1 0 14.14m-14.14 0a10 10 0 0 1 0-14.14"></path>
                        </svg>
                        <span class="honeypot-label">Honeypots</span>
                    </div>
                    <div class="stat-value" style="color: #10b981;">5</div>
                    <div class="honeypot-detail">SSH â€¢ S7 â€¢ Modbus â€¢ MQTT â€¢ HMI</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Dashboard - Fixed Grid Layout -->
    <div class="dashboard-section">
        <div class="container">
            <div class="dashboard-grid">

                <!-- ROW 1: Top IPs | Protocol Dist | Credentials (narrow) | Countries (wide) -->
                <div class="dashboard-card">
                    <h3 class="card-title">TOP ATTACKING IPs</h3>
                    <div id="attackingIPs" class="scrollable-list"></div>
                </div>

                <div class="dashboard-card">
                    <h3 class="card-title">PROTOCOL DISTRIBUTION</h3>
                    <canvas id="protocolChart"></canvas>
                </div>

                <div class="dashboard-card credentials-card">
                    <h3 class="card-title">TOP 3 USERNAMES</h3>
                    <div id="usernamesTable" class="compact-list"></div>

                    <h3 class="card-title" style="margin-top: 0.75rem;">TOP 3 PASSWORDS</h3>
                    <div id="passwordsTable" class="compact-list"></div>
                </div>

                <div class="dashboard-card countries-card">
                    <h3 class="card-title">TOP ATTACK COUNTRIES</h3>
                    <canvas id="countriesChart"></canvas>
                </div>

                <!-- ROW 2: Timeline (40%) | Failed Logins (30%) | Live Events (30%) -->
                <div class="dashboard-card timeline-card">
                    <h3 class="card-title">ATTACK TIMELINE (24H)</h3>
                    <canvas id="timelineChart"></canvas>
                </div>

                <div class="dashboard-card">
                    <h3 class="card-title">FAILED SSH LOGIN ATTEMPTS</h3>
                    <div id="failedLoginsList" class="scrollable-list"></div>
                </div>

                <div class="dashboard-card">
                    <h3 class="card-title">LIVE SSH EVENTS (5m)</h3>
                    <div id="eventStream" class="scrollable-list"></div>
                </div>

                <!-- ROW 3: Breaches (50%) | Executed Commands (50%) -->
                <div class="dashboard-card breach-card">
                    <h3 class="card-title">BREACHES</h3>
                    <div id="breachesList" class="scrollable-list"></div>
                </div>

                <div class="dashboard-card commands-card">
                    <h3 class="card-title">EXECUTED COMMANDS AFTER SSH BREACH</h3>
                    <div id="commandsDisplay" class="commands-display">
                        <div class="commands-placeholder">
                            <svg width="48" height="48" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                            </svg>
                            <p>No commands selected.</p>
                            <small>Click "View Commands" on a breach to display details here.</small>
                        </div>
                    </div>
                </div>

                <!-- ROW 4: HMI Logins | Protocol Activity | HTTP Logins | Repeat Offenders -->
                <div class="dashboard-card row4-card">
                    <h3 class="card-title">HMI WEB LOGIN ATTEMPTS</h3>
                    <div id="hmiLoginsList" class="table-container"></div>
                </div>

                <div class="dashboard-card row4-card">
                    <h3 class="card-title">PROTOCOL ACTIVITY</h3>
                    <canvas id="protocolActivityChart"></canvas>
                </div>

                <div class="dashboard-card row4-card">
                    <h3 class="card-title">RECENT HMI HTTP LOGIN ATTEMPTS</h3>
                    <div id="recentHTTPLoginsList" class="scrollable-list"></div>
                </div>

                <div class="dashboard-card row4-card">
                    <h3 class="card-title">REPEAT OFFENDERS</h3>
                    <div id="repeatOffendersList" class="table-container"></div>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <p>port254 - OT/ICS Security Research | Live Honeypot Telemetry | Powered by Elasticsearch & Conpot</p>
        </div>
    </footer>

    <script src="./js/dashboard.js"></script>
</body>
</html>
