<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MITRE ATT&CK ICS Matrix - port254</title>
    <link rel="stylesheet" href="./css/style.css">
    <style>
        .attack-hero {
            border-bottom: 1px solid #2a2a2a;
            padding: 3rem 1.5rem 2rem;
            text-align: center;
        }

        .attack-hero h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: #f3f4f6;
        }

        .attack-hero p {
            font-size: 1.125rem;
            color: #9ca3af;
            max-width: 800px;
            margin: 0 auto 1.5rem;
        }

        .attack-stats {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin-top: 1.5rem;
        }

        .attack-stat {
            text-align: center;
        }

        .attack-stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #60a5fa;
        }

        .attack-stat-label {
            font-size: 0.875rem;
            color: #9ca3af;
            text-transform: uppercase;
        }

        .matrix-container {
            padding: 2rem 1.5rem;
            max-width: 100%;
            overflow-x: auto;
        }

        .matrix-scroll {
            min-width: 1600px;
        }

        .matrix-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 0.75rem;
        }

        .tactic-column {
            background-color: #1a1a1a;
            border: 1px solid #2a2a2a;
            border-radius: 0.5rem;
            overflow: hidden;
        }

        .tactic-header {
            padding: 1rem;
            text-align: center;
            border-bottom: 2px solid #60a5fa;
        }

        .tactic-id {
            font-size: 0.7rem;
            color: #9ca3af;
            margin-bottom: 0.25rem;
        }

        .tactic-name {
            font-size: 0.875rem;
            font-weight: 600;
            color: #f3f4f6;
            margin-bottom: 0.5rem;
        }

        .tactic-count {
            font-size: 0.9rem;
            color: #60a5fa;
        }

        .techniques-list {
            padding: 0.5rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .technique-item {
            border: 1px solid #3a3a3a;
            border-radius: 0.375rem;
            padding: 0.75rem 0.5rem;
            font-size: 0.9rem;
            color: #9ca3af;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            line-height: 1.3;
        }

        .technique-item:hover {
            background-color: rgba(255, 107, 107, 0.1);
            border-color: #60a5fa;
            color: #e5e7eb;
            transform: translateY(-2px);
        }

        /* Technique Detail Modal */
        .technique-modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            overflow-y: auto;
        }

        .technique-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .technique-modal-content {
            background-color: #1a1a1a;
            border: 1px solid #2a2a2a;
            border-radius: 0.75rem;
            max-width: 900px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .technique-modal-header {
            background-color: #1a1a1a;
            border-bottom: 1px solid #2a2a2a;
            padding: 1.5rem;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .technique-modal-title {
            font-size: 1.5rem;
            color: #f3f4f6;
            margin-bottom: 0.5rem;
        }

        .technique-modal-id {
            color: #60a5fa;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .technique-modal-body {
            padding: 1.5rem;
        }

        .technique-section {
            margin-bottom: 1.5rem;
        }

        .technique-section-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: #9ca3af;
            text-transform: uppercase;
            margin-bottom: 0.75rem;
        }

        .technique-section-content {
            color: #e5e7eb;
            line-height: 1.8;
            font-size: 0.875rem;
        }

        .technique-tactics-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .technique-tactic-badge {
            background-color: rgba(255, 107, 107, 0.15);
            color: #60a5fa;
            padding: 0.375rem 0.75rem;
            border-radius: 0.375rem;
            font-size: 0.813rem;
            border: 1px solid rgba(255, 107, 107, 0.3);
        }

        .technique-close {
            position: absolute;
            right: 1.5rem;
            top: 1.5rem;
            background: none;
            border: none;
            color: #9ca3af;
            font-size: 2rem;
            cursor: pointer;
            width: 2rem;
            height: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: color 0.2s;
        }

        .technique-close:hover {
            color: white;
        }

        .legend {
            background-color: #1a1a1a;
            border: 1px solid #2a2a2a;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 2rem auto;
            max-width: 1200px;
        }

        .legend-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #f3f4f6;
            margin-bottom: 1rem;
        }

        .legend-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .legend-item {
            display: flex;
            gap: 0.75rem;
            align-items: flex-start;
        }

        .legend-color {
            width: 40px;
            height: 40px;
            border-radius: 0.375rem;
            flex-shrink: 0;
        }

        .legend-initial-access { background: linear-gradient(135deg, rgba(139, 92, 246, 0.3) 0%, rgba(139, 92, 246, 0.1) 100%); }
        .legend-execution { background: linear-gradient(135deg, rgba(59, 130, 246, 0.3) 0%, rgba(59, 130, 246, 0.1) 100%); }
        .legend-persistence { background: linear-gradient(135deg, rgba(16, 185, 129, 0.3) 0%, rgba(16, 185, 129, 0.1) 100%); }
        .legend-impact { background: linear-gradient(135deg, rgba(239, 68, 68, 0.3) 0%, rgba(239, 68, 68, 0.1) 100%); }

        .legend-text {
            font-size: 0.875rem;
            color: #9ca3af;
        }

        @media (max-width: 1024px) {
            .attack-stats {
                gap: 1.5rem;
            }

            .attack-stat-value {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <a href="index.html" style="text-decoration: none;">
                <h1 class="logo">port254</h1>
            </a>
        </div>
    </header>

    <!-- Navigation -->
    <div class="filters-section">
        <div class="container">
            <nav class="nav-menu" style="justify-content: center;">
                <a href="index.html" class="nav-link">Home</a>
                <a href="detections.html" class="nav-link">Detections</a>
                <a href="honeypot-dashboard.html" class="nav-link">Honeypot Dashboard</a>
                <a href="attack-matrix.html" class="nav-link active">ATT&CK Matrix</a>
                <a href="file-analysis.html" class="nav-link">File Analysis</a>
                <a href="incident-response.html" class="nav-link">Incident Response</a>
                <a href="getting-started.html" class="nav-link">Getting Started</a>
                <a href="documentation.html" class="nav-link">Documentation</a>
                <a href="contact.html" class="nav-link">Contact</a>
            </nav>
        </div>
    </div>

    <!-- Hero -->
    <div class="attack-hero">
        <h1>MITRE ATT&CK for ICS</h1>
        <p>Adversary tactics and techniques for Industrial Control Systems based on real-world observations</p>
        <div class="attack-stats">
            <div class="attack-stat">
                <div class="attack-stat-value">12</div>
                <div class="attack-stat-label">Tactics</div>
            </div>
            <div class="attack-stat">
                <div class="attack-stat-value">94</div>
                <div class="attack-stat-label">Techniques</div>
            </div>
        </div>
    </div>

    <!-- Matrix -->
    <div class="matrix-container">
        <div class="matrix-scroll">
            <div class="matrix-grid" id="matrixGrid">
                <!-- Matrix will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Technique Detail Modal -->
    <div id="techniqueModal" class="technique-modal">
        <div class="technique-modal-content">
            <div class="technique-modal-header">
                <button class="technique-close" onclick="closeTechniqueModal()">&times;</button>
                <div class="technique-modal-id" id="techniqueId"></div>
                <h2 class="technique-modal-title" id="techniqueName"></h2>
            </div>
            <div class="technique-modal-body">
                <div class="technique-section">
                    <h3 class="technique-section-title">Description</h3>
                    <div class="technique-section-content" id="techniqueDescription"></div>
                </div>
                <div class="technique-section">
                    <h3 class="technique-section-title">Tactics</h3>
                    <div class="technique-tactics-list" id="techniqueTactics"></div>
                </div>
                <div class="technique-section">
                    <h3 class="technique-section-title">Mitigations</h3>
                    <div class="technique-section-content" id="techniqueMitigations"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>port254 Detection Catalog | Powered by Conpot honeypot telemetry | Mapping to MITRE ATT&CK & IEC 62443</p>
        </div>
    </footer>

    <script>
        // ICS Tactics and Techniques Data
        const icsMatrix = {
            "Initial Access": {
                id: "TA0108",
                description: "The adversary is trying to get into your ICS environment.",
                techniques: [
                    { name: "Drive-by Compromise", id: "T0817" },
                    { name: "Exploit Public-Facing Application", id: "T0819" },
                    { name: "Exploitation of Remote Services", id: "T0866" },
                    { name: "External Remote Services", id: "T0822" },
                    { name: "Internet Accessible Device", id: "T0883" },
                    { name: "Remote Services", id: "T0886" },
                    { name: "Replication Through Removable Media", id: "T0847" },
                    { name: "Rogue Master", id: "T0848" },
                    { name: "Spearphishing Attachment", id: "T0865" },
                    { name: "Supply Chain Compromise", id: "T0862" },
                    { name: "Transient Cyber Asset", id: "T0864" },
                    { name: "Wireless Compromise", id: "T0860" }
                ]
            },
            "Execution": {
                id: "TA0104",
                description: "The adversary is trying to run code or manipulate system functions, parameters, and data in an unauthorized way.",
                techniques: [
                    { name: "Autorun Image", id: "T0803" },
                    { name: "Change Operating Mode", id: "T0858" },
                    { name: "Command-Line Interface", id: "T0807" },
                    { name: "Execution through API", id: "T0871" },
                    { name: "Graphical User Interface", id: "T0823" },
                    { name: "Hooking", id: "T0874" },
                    { name: "Modify Controller Tasking", id: "T0821" },
                    { name: "Native API", id: "T0834" },
                    { name: "Scripting", id: "T0853" },
                    { name: "User Execution", id: "T0863" }
                ]
            },
            "Persistence": {
                id: "TA0110",
                description: "The adversary is trying to maintain their foothold in your ICS environment.",
                techniques: [
                    { name: "Hardcoded Credentials", id: "T0891" },
                    { name: "Modify Program", id: "T0889" },
                    { name: "Module Firmware", id: "T0839" },
                    { name: "Project File Infection", id: "T0873" },
                    { name: "System Firmware", id: "T0857" },
                    { name: "Valid Accounts", id: "T0859" }
                ]
            },
            "Privilege Escalation": {
                id: "TA0111",
                description: "The adversary is trying to gain higher-level permissions.",
                techniques: [
                    { name: "Exploitation for Privilege Escalation", id: "T0890" },
                    { name: "Hooking", id: "T0874" }
                ]
            },
            "Evasion": {
                id: "TA0103",
                description: "The adversary is trying to avoid security defenses.",
                techniques: [
                    { name: "Change Operating Mode", id: "T0858" },
                    { name: "Exploitation for Evasion", id: "T0820" },
                    { name: "Indicator Removal on Host", id: "T0872" },
                    { name: "Masquerading", id: "T0849" },
                    { name: "Rootkit", id: "T0851" },
                    { name: "Spoof Reporting Message", id: "T0856" },
                    { name: "System Binary Proxy Execution", id: "T0202" }
                ]
            },
            "Discovery": {
                id: "TA0102",
                description: "The adversary is locating information to assess and identify their targets in your environment.",
                techniques: [
                    { name: "Network Connection Enumeration", id: "T0840" },
                    { name: "Network Sniffing", id: "T0842" },
                    { name: "Remote System Discovery", id: "T0846" },
                    { name: "Remote System Information Discovery", id: "T0888" },
                    { name: "Wireless Sniffing", id: "T0887" }
                ]
            },
            "Lateral Movement": {
                id: "TA0109",
                description: "The adversary is trying to move through your ICS environment.",
                techniques: [
                    { name: "Default Credentials", id: "T0812" },
                    { name: "Exploitation of Remote Services", id: "T0866" },
                    { name: "Hardcoded Credentials", id: "T0891" },
                    { name: "Lateral Tool Transfer", id: "T0867" },
                    { name: "Program Download", id: "T0843" },
                    { name: "Remote Services", id: "T0886" },
                    { name: "Valid Accounts", id: "T0859" }
                ]
            },
            "Collection": {
                id: "TA0100",
                description: "The adversary is trying to gather data of interest and domain knowledge on your ICS environment to inform their goal.",
                techniques: [
                    { name: "Adversary-in-the-Middle", id: "T0830" },
                    { name: "Automated Collection", id: "T0802" },
                    { name: "Data from Information Repositories", id: "T0811" },
                    { name: "Data from Local System", id: "T0893" },
                    { name: "Detect Operating Mode", id: "T0868" },
                    { name: "I/O Image", id: "T0877" },
                    { name: "Monitor Process State", id: "T0801" },
                    { name: "Point & Tag Identification", id: "T0861" },
                    { name: "Program Upload", id: "T0845" },
                    { name: "Screen Capture", id: "T0852" },
                    { name: "Wireless Sniffing", id: "T0887" }
                ]
            },
            "Command and Control": {
                id: "TA0101",
                description: "The adversary is trying to communicate with and control compromised systems, controllers, and platforms with access to your ICS environment.",
                techniques: [
                    { name: "Commonly Used Port", id: "T0885" },
                    { name: "Connection Proxy", id: "T0884" },
                    { name: "Standard Application Layer Protocol", id: "T0869" }
                ]
            },
            "Inhibit Response Function": {
                id: "TA0107",
                description: "The adversary is trying to prevent your safety, protection, quality assurance, and operator intervention functions from responding to a failure, hazard, or unsafe state.",
                techniques: [
                    { name: "Activate Firmware Update Mode", id: "T0800" },
                    { name: "Alarm Suppression", id: "T0878" },
                    { name: "Block Command Message", id: "T0803" },
                    { name: "Block Reporting Message", id: "T0804" },
                    { name: "Block Serial COM", id: "T0805" },
                    { name: "Change Credential", id: "T0892" },
                    { name: "Data Destruction", id: "T0809" },
                    { name: "Denial of Service", id: "T0814" },
                    { name: "Device Restart/Shutdown", id: "T0816" },
                    { name: "Manipulate I/O Image", id: "T0835" },
                    { name: "Modify Alarm Settings", id: "T0838" },
                    { name: "Rootkit", id: "T0851" },
                    { name: "Service Stop", id: "T0881" },
                    { name: "System Firmware", id: "T0857" }
                ]
            },
            "Impair Process Control": {
                id: "TA0106",
                description: "The adversary is trying to manipulate, disable, or damage physical control processes.",
                techniques: [
                    { name: "Brute Force I/O", id: "T0806" },
                    { name: "Modify Parameter", id: "T0836" },
                    { name: "Module Firmware", id: "T0839" },
                    { name: "Spoof Reporting Message", id: "T0856" },
                    { name: "Unauthorized Command Message", id: "T0855" }
                ]
            },
            "Impact": {
                id: "TA0105",
                description: "The adversary is trying to manipulate, interrupt, or destroy your ICS systems, data, and their surrounding environment.",
                techniques: [
                    { name: "Damage to Property", id: "T0879" },
                    { name: "Denial of Control", id: "T0813" },
                    { name: "Denial of View", id: "T0815" },
                    { name: "Loss of Availability", id: "T0826" },
                    { name: "Loss of Control", id: "T0827" },
                    { name: "Loss of Productivity and Revenue", id: "T0828" },
                    { name: "Loss of Protection", id: "T0837" },
                    { name: "Loss of Safety", id: "T0880" },
                    { name: "Loss of View", id: "T0829" },
                    { name: "Manipulation of Control", id: "T0831" },
                    { name: "Manipulation of View", id: "T0832" },
                    { name: "Theft of Operational Information", id: "T0882" }
                ]
            }
        };

        // Populate matrix
        function populateMatrix() {
            const grid = document.getElementById('matrixGrid');
            
            Object.entries(icsMatrix).forEach(([tacticName, tacticData]) => {
                const column = document.createElement('div');
                column.className = 'tactic-column';
                
                column.innerHTML = `
                    <div class="tactic-header">
                        <div class="tactic-id">${tacticData.id}</div>
                        <div class="tactic-name">${tacticName}</div>
                        <div class="tactic-count">${tacticData.techniques.length} techniques</div>
                    </div>
                    <div class="techniques-list">
                        ${tacticData.techniques.map(tech => `
                            <div class="technique-item" onclick='showTechniqueDetail(${JSON.stringify(tech)}, "${tacticName}")'>
                                <div style="font-size: 0.65rem; color: #60a5fa; margin-bottom: 0.25rem;">${tech.id}</div>
                                ${tech.name}
                            </div>
                        `).join('')}
                    </div>
                `;
                
                grid.appendChild(column);
            });
        }

        // Show technique detail
        function showTechniqueDetail(technique, tacticName) {
            document.getElementById('techniqueId').textContent = technique.id;
            document.getElementById('techniqueName').textContent = technique.name;
            
            // Sample description - in real implementation, fetch from MITRE API
            document.getElementById('techniqueDescription').textContent = 
                `${technique.name} is a technique used by adversaries in ICS environments. This technique is categorized under the ${tacticName} tactic and represents a specific method attackers use to achieve their objectives in industrial control systems.`;
            
            // Show tactics
            document.getElementById('techniqueTactics').innerHTML = `
                <div class="technique-tactic-badge">${tacticName}</div>
            `;
            
            // Sample mitigations
            document.getElementById('techniqueMitigations').innerHTML = `
                <ul style="padding-left: 1.5rem; color: #9ca3af;">
                    <li>Network segmentation to limit lateral movement</li>
                    <li>Application allowlisting to prevent unauthorized execution</li>
                    <li>Monitor for unusual process activity and command execution</li>
                    <li>Implement least privilege access controls</li>
                </ul>
            `;
            
            document.getElementById('techniqueModal').classList.add('active');
        }

        // Close modal
        function closeTechniqueModal() {
            document.getElementById('techniqueModal').classList.remove('active');
        }

        // Close on outside click
        document.getElementById('techniqueModal').addEventListener('click', function(e) {
            if (e.target.id === 'techniqueModal') {
                closeTechniqueModal();
            }
        });

        // Close on Escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeTechniqueModal();
            }
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', populateMatrix);
    </script>
</body>
</html>
